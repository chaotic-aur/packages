ALL_OFF="$(tput sgr0)"
YELLOW="${BOLD}$(tput setaf 3)"
WHITE="${BOLD}$(tput setaf 7)"

_warning_root() {
  local _warning="apollo has root access"
  printf "${YELLOW}WARNING: ${WHITE}%s${ALL_OFF}\n" "$_warning"
}

do_setcap() {
  _warning_root
  setcap cap_sys_admin+p $(readlink -f usr/bin/apollo-server)
}

do_udev_reload() {
  udevadm control --reload-rules
  udevadm trigger --property-match=DEVNAME=/dev/uinput
  modprobe uinput || true
}

post_install() {
  do_setcap
  do_udev_reload
}

post_upgrade() {
  do_setcap
  do_udev_reload
}

